"use strict";(self.webpackChunktemplate_rpm_adnare=self.webpackChunktemplate_rpm_adnare||[]).push([[209],{53209:(O,S,o)=>{o.r(S),o.d(S,{NoteSearchModule:()=>J});var m=o(36895),g=o(62510),h=o(90433),p=o(46773),v=o(49671),y=o(88938),D=o(35226),_=o.n(D),z=o(54641),C=o(58493),e=o(94650),Z=o(39503),l=o(40269),T=o(31237),N=o(31453),b=o(70827);function x(i,d){if(1&i){const n=e.EpF();e.TgZ(0,"tbody")(1,"tr"),e.ynx(2),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td",41),e.NdJ("click",function(){const a=e.CHM(n).$implicit,r=e.oxw();return e.KtG(r.navigateToReadingScreen(a.patient_reading_id))}),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.ALo(16,"date"),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA(),e.BQk(),e.qZA()()}if(2&i){const n=d.$implicit;e.xp6(4),e.Oqu(n.enterprise_name),e.xp6(2),e.Oqu(n.patient_name),e.xp6(2),e.Oqu(n.device_type),e.xp6(2),e.Oqu(n.reading),e.xp6(2),e.Oqu(e.Dn7(13,9,n.start_date,"short","IST")),e.xp6(3),e.Oqu(e.Dn7(16,13,n.amendment_date,"short","IST")),e.xp6(3),e.Oqu(n.message),e.xp6(2),e.Oqu(n.time_spent),e.xp6(2),e.Oqu(n.user_name)}}function A(i,d){1&i&&e._UZ(0,"tbody")}z.vfs=C.I.vfs;let M=(()=>{class i{constructor(n,t,s){this.patientService=n,this.router=t,this.datepipe=s,this.pageIndex=1,this.pageSize=10,this.pageSizeOptions=[10,20,30,40],this.patient_name="",this.user_name="",this.fromDate=null,this.toDate=null,this.get_all_data=!1,this.totalNotes=0,this.changePageSize=10,this.user_first_name="",this.user_last_name=""}ngOnInit(){this.is_active=""}buildTableBody(n,t){var s=[];return s.push(t),n.forEach(a=>{var r=[];t.forEach(function(c){r.push(a[c.text])}),s.push(r)}),s}table(n,t){return{table:{headerRows:1,body:this.buildTableBody(n,t),dontBreakRows:!0,fontSize:7,widths:[50,50,55,55,55,100,50,40]}}}downloadAllNotesData(n){var t=this;return(0,v.Z)(function*(){if(t.patient_name){const s=t.patient_name.split(" ");s.length>1?(t.first_name=s[0].toLowerCase(),t.last_name=s[s.length-1].toLowerCase()):(t.patient_name=t.patient_name.toLowerCase(),t.first_name="",t.last_name="")}if(t.user_name){const s=t.user_name.split(" ");s.length>1?(t.user_first_name=s[0].toLowerCase(),t.user_last_name=s[s.length-1].toLowerCase()):(t.user_name=t.user_name.toLowerCase(),t.user_first_name="",t.user_last_name="")}t.search_model={user_id:localStorage.getItem("user_id"),sort_order:t.sortOrder??"",sort_coloumn:t.sortField??"",page_number:t.pageIndex,page_size:t.pageSize,enterprise_id:t.enterprise??"",first_name:t.first_name??"",last_name:t.last_name??"",from_date:null==t.fromDate?"":t.convert(t.fromDate),to_date:null==t.toDate?"":t.convert(t.toDate),serial_number:t.serial_number??"",get_all_data:!0,patient_name:t.patient_name,user_first_name:t.user_first_name,user_last_name:t.user_last_name,user_name:t.user_name},t.patientService.getNoteSearchData(t.search_model).subscribe(s=>{1==s.success?(t.providerExportData=s.data.map(a=>({Entity:a.enterprise_name,"Patient Name":a.patient_name??"","Device Type":a.device_type??"",Reading:a.reading??"",Date:null==a.start_date?"":t.datepipe.transform(a.start_date,"MM/dd/yyyy"),Notes:a.message??"","Time Spent (mm:ss)":a.time_spent??"","Added By":a.user_name??""})),"pdf"==n&&t.exportToPdf(t.providerExportData),"csv"==n&&t.exportToCsv(t.providerExportData)):_().fire({icon:"error",text:s.message})})})()}downloadNotesData(n){null!=this.notesData&&0!=this.notesData.length?this.downloadAllNotesData(n):_().fire({icon:"error",text:"No Record to Download"})}exportToCsv(n){new y.Sv(n,"Notes",{fieldSeparator:",",quoteStrings:'"',decimalseparator:".",title:"",useBom:!0,noDownload:!1,headers:["Entity","Patient Name","Device Type","Reading","Date","Notes","Time Spent (mm:ss)","Added By"]})}exportToPdf(n){var s={content:[{text:"Notes",fontSize:12,bold:!0},this.table(n,[{text:"Entity",style:"tableHeader"},{text:"Patient Name",style:"tableHeader"},{text:"Device Type",style:"tableHeader"},{text:"Reading",style:"tableHeader"},{text:"Date",style:"tableHeader"},{text:"Notes",style:"tableHeader"},{text:"Time Spent (mm:ss)",style:"tableHeader"},{text:"Added By",style:"tableHeader"}])],defaultStyle:{fontSize:9},styles:{tableHeader:{bold:!0,fontSize:9,color:"white",fillColor:"#4A2D73"}}};z.createPdf(s).download("Notes.pdf")}getEnterpriseSearchDropdown(){this.userId=localStorage.getItem("user_id"),this.patientService.getActiveEnterpriseDropdownData(this.userId).subscribe(n=>{1==n.success?(this.enterpriseData=n.data,1==this.enterpriseData.length&&(this.enterprise=this.enterpriseData[0].id)):_().fire({icon:"error",text:n.message})})}onQueryParamsChange(n){var t=this;return(0,v.Z)(function*(){t.prev_pageIndex=null!=t.savedParams?t.savedParams.pageIndex:null,t.savedParams=n;const{pageIndex:a,sort:r}=n,u=r.find(f=>null!==f.value);t.sortField=u&&u.key||null,t.sortOrder=u&&u.value||null,t.pageIndex=a,(null!=t.notesData&&null!=t.sortField&&null!=t.sortOrder||null!=t.prev_pageIndex&&t.prev_pageIndex!=t.pageIndex||t.changePageSize!=t.pageSize)&&t.getNotesGridData(),t.changePageSize=t.pageSize})()}convert(n){const t=new Date(n),s=("0"+(t.getMonth()+1)).slice(-2),a=("0"+t.getDate()).slice(-2),r=("0"+t.getHours()).slice(-2),c=("0"+t.getHours()).slice(-2),u=("0"+t.getHours()).slice(-2);return[[t.getFullYear(),s,a].join("-"),[r,c,u].join(":")].join(" ")}getNotesGridData(){if(this.patient_name){const n=this.patient_name.split(" ");n.length>1?(this.first_name=n[0].toLowerCase(),this.last_name=n[n.length-1].toLowerCase()):(this.patient_name=this.patient_name.toLowerCase(),this.first_name="",this.last_name="")}if(this.user_name){const n=this.user_name.split(" ");n.length>1?(this.user_first_name=n[0].toLowerCase(),this.user_last_name=n[n.length-1].toLowerCase()):(this.user_name=this.user_name.toLowerCase(),this.user_first_name="",this.user_last_name="")}this.search_model={user_id:localStorage.getItem("user_id"),sort_order:this.sortOrder??"",sort_coloumn:this.sortField??"",page_number:this.pageIndex,page_size:this.pageSize,enterprise_id:this.enterprise??"",first_name:this.first_name??"",last_name:this.last_name??"",from_date:null==this.fromDate?"":this.convert(this.fromDate),to_date:null==this.toDate?"":this.convert(this.toDate),serial_number:this.serial_number??"",notes:this.notes??"",get_all_data:this.get_all_data,patient_name:this.patient_name,user_first_name:this.user_first_name,user_last_name:this.user_last_name,user_name:this.user_name},this.patientService.getNoteSearchData(this.search_model).subscribe(n=>{if(1==n.success){this.notesData=n.data,this.totalNotes=n.data.length>0?n.data[0].total_record_count:0;for(let t=0;this.notesData.length>t;t++)!this.notesData[t]||!this.notesData[t].start_date&&!this.notesData[t].amendment_date||this.notesData[t].start_date.toString().includes("z")&&this.notesData[t].amendment_date.toString().includes("z")?(this.notesData[t].start_date=this.datepipe.transform(this.notesData[t].start_date,"M/d/yy, h:mm a"),this.notesData[t].amendment_date=this.datepipe.transform(this.notesData[t].amendment_date,"M/d/yy, h:mm a")):(this.notesData[t].start_date=this.datepipe.transform(this.notesData[t].start_date+"Z","M/d/yy, h:mm a"),this.notesData[t].amendment_date=this.datepipe.transform(this.notesData[t].amendment_date+"Z","M/d/yy, h:mm a"))}else _().fire({icon:"error",text:n.message})})}search(){this.pageIndex=1,this.getNotesGridData()}handleClear(){this.last_name="",this.first_name="",this.patient_name="",this.user_last_name="",this.user_first_name="",this.user_name="",this.fromDate=null,this.toDate=null,this.serial_number="",this.notes="",this.getNotesGridData()}navigateToReadingScreen(n){null!=n&&null!=n&&""!=n&&(this.patientService.navigateFromNotesDashboard=!0,this.patientService.patient_reading_id=n,this.router.navigate(["/reading-board"]))}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(Z.e),e.Y36(g.F0),e.Y36(m.uU))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-notes-search"]],decls:70,vars:29,consts:[[1,"screen"],[1,"screen-header"],[1,"screen-name"],["ngbTooltip","Search","tooltipClass","custom-search-tooltip-color",1,"screen-header-btn","margin-right",3,"click"],[1,"fa","fa-search"],[1,"screen-header-btn","margin-right",3,"click"],[1,"pipe"],["ngbDropdown","",1,"d-inline-block"],["Export","ngbDropdown"],["id","dropdownManual2",1,"screen-header-btn","margin-right",3,"focus"],[3,"src"],[1,"pipe-inside-btn"],[1,"fa","fa-chevron-down"],["ngbDropdownMenu","","aria-labelledby","dropdownManual2"],["ngbDropdownItem","",1,"screen-header-btn","margin-right",3,"click"],[1,"fa","fa-file-csv"],[1,"fa","fa-file-pdf"],[1,"screen-search-criteria-div"],[1,"row"],[1,"col-lg-4","col-md-4","col-sm-6","col-xs-6"],["type","text","placeholder","Patient Name","label","Patient Name","accesskey","P","icon","fa fa-user","align_icon","left",3,"ngModel","ngModelChange"],["type","text","placeholder","Notes","label","Notes","accesskey","N","icon","fa fa-user","align_icon","left",3,"ngModel","ngModelChange"],["type","text","placeholder","Added By","label","Added By","accesskey","A","icon","fa fa-user","align_icon","left",3,"ngModel","ngModelChange"],["label","From Date","icon","fa fa-calendar","accesskey","r","align_icon","left",3,"ngModel","ngModelChange"],["label","To Date","accesskey","T","icon","fa fa-calendar","align_icon","left",3,"ngModel","ngModelChange"],[1,"table-div"],["nzShowSizeChanger","",1,"ch-table",3,"nzPageSizeOptions","nzFrontPagination","nzTotal","nzPageIndex","nzPageSize","nzData","nzQueryParams","nzPageIndexChange","nzPageSizeChange"],["nzTable","","sortTable","","filterTable",""],["nzColumnKey","enterprise_name",3,"nzSortFn"],["nzColumnKey","patient_name",3,"nzSortFn"],["nzColumnKey","device_type",3,"nzSortFn"],["nzColumnKey","reading",3,"nzSortFn"],["nzColumnKey","start_date",3,"nzSortFn"],["nzColumnKey","amendment_date",3,"nzSortFn"],["nzColumnKey","notes",3,"nzSortFn"],["nzColumnKey","duration",3,"nzSortFn"],["nzColumnKey","user",3,"nzSortFn"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"total"],[1,"total-span"],[1,"text-decoration",3,"click"]],template:function(n,t){if(1&n){const s=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3," Notes Search "),e.qZA(),e.TgZ(4,"div")(5,"button",3),e.NdJ("click",function(){return t.search()}),e._UZ(6,"span",4),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){return t.handleClear()}),e._uU(8,"Clear All"),e.qZA(),e._UZ(9,"span",6),e.TgZ(10,"div",7,8)(12,"button",9),e.NdJ("focus",function(){e.CHM(s);const r=e.MAs(11);return e.KtG(r.open())}),e._UZ(13,"img",10),e.ALo(14,"assetsSource"),e._uU(15," Export "),e._UZ(16,"span",11)(17,"span",12),e.qZA(),e.TgZ(18,"div",13)(19,"button",14),e.NdJ("click",function(){return t.downloadNotesData("csv")}),e._UZ(20,"i",15),e._uU(21," CSV "),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){return t.downloadNotesData("pdf")}),e._UZ(23,"i",16),e._uU(24," PDF "),e.qZA()()()()(),e.TgZ(25,"div",17)(26,"div",18)(27,"div",19)(28,"app-ad-custom-input",20),e.NdJ("ngModelChange",function(r){return t.patient_name=r}),e.qZA()(),e.TgZ(29,"div",19)(30,"app-ad-custom-input",21),e.NdJ("ngModelChange",function(r){return t.notes=r}),e.qZA()(),e.TgZ(31,"div",19)(32,"app-ad-custom-input",22),e.NdJ("ngModelChange",function(r){return t.user_name=r}),e.qZA()()(),e.TgZ(33,"div",18)(34,"div",19)(35,"app-ad-custom-date",23),e.NdJ("ngModelChange",function(r){return t.fromDate=r}),e.qZA()(),e.TgZ(36,"div",19)(37,"app-ad-custom-date",24),e.NdJ("ngModelChange",function(r){return t.toDate=r}),e.qZA()()(),e.TgZ(38,"div",25)(39,"nz-table",26,27),e.NdJ("nzQueryParams",function(r){return t.onQueryParamsChange(r)})("nzPageIndexChange",function(r){return t.pageIndex=r})("nzPageSizeChange",function(r){return t.pageSize=r}),e.TgZ(43,"thead")(44,"tr")(45,"th",28),e._uU(46,"Entity"),e.qZA(),e.TgZ(47,"th",29),e._uU(48,"Patient Name"),e.qZA(),e.TgZ(49,"th",30),e._uU(50,"Device Type"),e.qZA(),e.TgZ(51,"th",31),e._uU(52,"Reading"),e.qZA(),e.TgZ(53,"th",32),e._uU(54,"Date"),e.qZA(),e.TgZ(55,"th",33),e._uU(56,"Amendment Date"),e.qZA(),e.TgZ(57,"th",34),e._uU(58,"Notes"),e.qZA(),e.TgZ(59,"th",35),e._uU(60,"Time Spent (mm:ss)"),e.qZA(),e.TgZ(61,"th",36),e._uU(62,"Added By"),e.qZA()()(),e.YNc(63,x,23,17,"tbody",37),e.YNc(64,A,1,0,"tbody",38),e.qZA(),e.TgZ(65,"div",39),e._UZ(66,"img",10),e.ALo(67,"assetsSource"),e.TgZ(68,"span",40),e._uU(69),e.qZA()()()()()}if(2&n){const s=e.MAs(41);e.xp6(13),e.Q6J("src",e.lcZ(14,25,"export.png"),e.LSH),e.xp6(15),e.Q6J("ngModel",t.patient_name),e.xp6(2),e.Q6J("ngModel",t.notes),e.xp6(2),e.Q6J("ngModel",t.user_name),e.xp6(3),e.Q6J("ngModel",t.fromDate),e.xp6(2),e.Q6J("ngModel",t.toDate),e.xp6(2),e.Q6J("nzPageSizeOptions",t.pageSizeOptions)("nzFrontPagination",!1)("nzTotal",t.totalNotes)("nzPageIndex",t.pageIndex)("nzPageSize",t.pageSize)("nzData",t.notesData),e.xp6(6),e.Q6J("nzSortFn",!0),e.xp6(2),e.Q6J("nzSortFn",!0),e.xp6(2),e.Q6J("nzSortFn",!0),e.xp6(2),e.Q6J("nzSortFn",!0),e.xp6(2),e.Q6J("nzSortFn",!0),e.xp6(2),e.Q6J("nzSortFn",!0),e.xp6(2),e.Q6J("nzSortFn",!0),e.xp6(2),e.Q6J("nzSortFn",!0),e.xp6(2),e.Q6J("nzSortFn",!0),e.xp6(2),e.Q6J("ngForOf",s.data),e.xp6(1),e.Q6J("ngIf",0==s.data.length),e.xp6(2),e.Q6J("src",e.lcZ(67,27,"total.png"),e.LSH),e.xp6(3),e.Oqu(t.totalNotes)}},dependencies:[m.sg,m.O5,l.N8,l.qD,l.Uo,l._C,l.Om,l.p0,l.$Z,h.JJ,h.On,p.jt,p.Vi,p.TH,p._L,T.y,N.m,m.uU,b.n],styles:[".margin-top-left[_ngcontent-%COMP%]{margin-top:17px}"]}),i})();var F=o(91083),U=o(29193);const P=[{path:"",component:M}];let J=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.ez,F.T,g.Bz.forChild(P),h.u5,h.UX,p.IJ,U.m,g.Bz]}),i})()}}]);